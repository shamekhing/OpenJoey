// yaneDirectInput.h
//	 This is DirectInput wrapper.
//		programmed by yaneurao(M.Isozaki) '99/06/18
//		modified by yaneurao '00/02/29

#ifndef __yaneDirectMusic_h__
#define __yaneDirectMusic_h__

#include "../Auxiliary/yaneCOMBase.h"

#if USE_DirectMusic
#include <dmusicc.h>
#include <dmusici.h>
#endif

namespace yaneuraoGameSDK3rd {
namespace Multimedia {

class CDirectSound;

#if USE_DirectMusic
class CDirectMusic {
/**
	DirectMusic?????????????N???X
	class CMIDIOutputDM ???g?p
*/
public:
	static bool CanUseDirectMusic();
	/**
		DirectMusic???g????�?????????????????
		???????????P??????o??????????x???o?????????B
	*/

	/**
		?R???X?g???N?^??????I??DirectMusic????????????????A
		?????????A?K?v?????????????????????B
	*/
	CCOMObject<IDirectMusicPerformance*>* GetDirectMusicPerformance()
		{ return& m_vDirectMusicPerformance;}
	//	IDirectMusicPerformace???ADirectMusic????

	CCOMObject<IDirectMusicLoader*>* GetDirectMusicLoader()
		{ return& m_vDirectMusicLoader;}
	//	?????????IDirectMusicLoader??IDirectMusicSegment??
	//	??????A?????�??S???B

	int	GetStatus() const { return m_nStatus; }
	/**
		DirectInput???????????�???A???U???g????
		0:ok(DirectX6??~)
		1,2,3:failure(DirectX6?????????? or
			DirectMusic?????????????s)
	*/

	CDirectMusic(CDirectSound* p=NULL);
	/**
		??A????DirectSound?I?u?W?F?N?g???w???????A
		????DirectMusic??A????DirectSound??v???C?}?????p????
		???????????o????B??????w????????A?f?B?t?H???g?????
		22kHz?????????????B
	*/

	virtual ~CDirectMusic();

protected:
	LPDIRECTSOUND m_pDirectSound;	//	CDirectSound?o?R??????????
	LPDIRECTSOUND GetDirectSound() const { return m_pDirectSound; }

	CCOMObject<IDirectMusicPerformance*>	m_vDirectMusicPerformance;
	IDirectMusic* m_lpDMusic;
	//	IDirectMusic??A?P??DirectSound???????????????
	CCOMObject<IDirectMusicLoader*>	m_vDirectMusicLoader;
	int		m_nStatus;	//	????????????�????GetStatus???Q??????

};
#else
// Stub when building without legacy DirectX SDK (no dmusici.h)
class CDirectMusic {
public:
	static bool CanUseDirectMusic() { return false; }
	CDirectMusic(CDirectSound* p = NULL) { (void)p; }
};
#endif

} // end of namespace Multimedia
} // end of namespace yaneuraoGameSDK3rd

#endif
