<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META name="GENERATOR" content="IBM HomePage Builder 2001 V5.0.0 for Windows">
<TITLE>FAQ</TITLE>
</HEAD><BODY bgcolor="#ccffcc" text="#336633" link="#0066cc" vlink="#009999" alink="#ff9900">
<P><FONT size="+2">よくある質問と回答</FONT></P>
<HR>
<P>Ｑ：ウィンドゥの左上のアイコンを自分の作ったものにしたいのですが。<BR>
Ｑ：exeファイルのアイコンを自分の作ったものにしたいのですが。</P>
<P>Ａ：VisualC++でなら、挿入→リソースで、プロジェクトにリソースを挿入しそこにアイコンをインポート（ないしは作成）します。</P>
<P>その後、プロジェクト→プロジェクトに追加→ファイルで、そのリソースをプロジェクトに追加します。</P>
<P>アイコンには&quot;main&quot;（このダブルコーテーションも必要です。かつ小文字にしてください）という名前のＩＤをつければ、それが表示されるようになるはずです。（16*16と32*32と両方、用意したほうがいいと思います）</P>
<HR>
<P>Ｑ：システムメニュー付きのウィンドゥにしたいのですが。</P>
<P>Ａ：メニューの作りかたから説明すると長くなるので、そのへんは入門書か何かで知っていることを前提に説明します。<BR>
VisualC++でなら、挿入→リソースで、プロジェクトにリソースを挿入しそこにメニューをインポート（ないしは作成）します。</P>
<P>その後、プロジェクト→プロジェクトに追加→ファイルで、そのリソースをプロジェクトに追加します。</P>
<P>メニューには&quot;IDR_MENU&quot;（このダブルコーテーションも必要です）という名前のＩＤをつけます。そして、CAppBaseのOnPreCreateで、スタイルとして、</P>
<TABLE bgcolor="#ffffff">
  <TBODY>
	<TR>
	  <TD>virtual LRESULT OnPreCreate(CWindowOption&amp;
	  opt){<BR>
	  opt.caption = &quot;画像 Viewer&quot;;<BR>
	  opt.classname = &quot;YANEAPPLICATION&quot;;<BR>
	  opt.size_x = 640;<BR>
	  opt.size_y = 480;<BR>
	  <FONT color="#cc0000">opt.style = WS_MINIMIZEBOX | WS_CAPTION |
	  WS_SYSMENU;</FONT><BR>
	  return 0;<BR>
	  }</TD>
	</TR>
  </TBODY>
</TABLE>
<P>と、WS_SYSMENUとWS_CAPTIONをつけたスタイルを指定します。あとは、メニューのWindowメッセージを処理するルーチンを書かなくてはならないのですが、それにはCWinHookを派生させて、メニューメッセージを処理するクラスを書きます。コンストラクタとデストラクタでHook〜Unhookしておくと良いでしょう。メッセージのフックの仕方については、CMouseが参考になるでしょう。</P>
<P>フルスクリーン時にメニューを出すためには、描画はCDirectDrawではなく、CDIBDrawでなくてはなりません。また、フルスクリーン時にソフトウェアマウスカーソルを使っているとメニューを出したときにカーソルが消えてしまいます。仕方ないと言えば仕方ないのですが．．．</P>
<HR>
<P>Ｑ：グローバルスコープのCPlaneやCSoundを使うと、終了時にメモリエラーが出たりするのですが。</P>
<P>Ａ：CPlane,CSoundのコンストラクタが起動される段階で、DirectDraw,DirectSoundの初期化が終了していないことが原因です。グローバルスコープに置かないでください。</P>
<HR>
<P>Ｑ．&quot;yaneVirtualKey.h&quot;のCVKeyList
m_VKey[VIRTUAL_KEY_MAX];で、「演算子は関数として宣言しなければならない」というなんとも的外れなエラーを出されてしまいます。</P>
<P>Ａ．Visual C++のユーザー定義クラスのsetのテンプレート展開のバグです。Visual
C++5.0,Visual C++6.0ならばサービスパック3以降で修正されています。</P>
<HR>
<P>Ｑ：ゲームが作れないんですが。</P>
<P>Ａ：すんません（笑）</P>
<P>プログラミングの知識がないことには、これだけあっても簡単にゲームが作れるってわけではありません。</P>
<P>ただ、Ｗｉｎｄｏｗｓプログラミングのことについて、ほとんど知らなくてもなんとかゲームが作れちゃう。そんなライブラリなのです。</P>
<HR>
<P>-----------------------------------------------------------------------------<BR>
初心者向けのガイド　（この文章は自由に引用して構いません）<BR>
-----------------------------------------------------------------------------<BR>
<BR>
///// 描画 /////<BR>
<BR>
Ｑ）描画が凄く遅いんですけど<BR>
Ａ）フルスクリーンモードに切り替えてみてください。（ウィンドゥの右上の×印の１つ左のボタンを押せばフルスクリーンに切り替えることが出来ます）ウィンドゥモードでは、相当マシンパワーを消費しますので。</P>
<P>また、Windows95/98の場合、システムのプロパティ→パフォーマンス→グラフィックスでアクセラレータのレベルが最大になっていないと描画にハードウェアの機能が利用できないので非常に遅い場合があります。</P>
<P>Ｑ）フルスクリーンモードにならないんですけど。<BR>
Ａ）ノートパソコン等では、解像度の切り替えを禁止しているビデオドライバが存在します。その場合、コントロールパネル→画面→ディスプレイの設定で、640×480，256色を選択して再起動をしてから実行してください。</P>
<P>Ｑ）640×480の256色という設定が見当たらないのですが。<BR>
Ａ）その場合、フルスクリーンモードの使用は出来ません。ウィンドゥモードでの使用のみとなります。ただし、色数は256色にしておいたほうが、若干のスピードアップが期待できるはずです。</P>
<P>Ｑ）うちはPentium200MHzなのですが、ウィンドゥモードだと遅いです。なぜでしょう？<BR>
Ａ）ビデオカードの容量が少ない場合、高解像度にするとビデオメモリが利用できないため、速度面でずいぶんと不利になります。解像度、色数を下げるなどしてみてください。ＩＥ４．０が悪さをして遅いということも考えられます。アクティブデスクトップをオフにするなどしてみてください。</P>
<P>Ｑ）ノートパソコンを使っていてPentiumIIの233MHzなのですが、案外遅いです。<BR>
Ａ）ビデオカードのドライバを新しいものに変えてみれば、少し改善されるかも知れません。ノートパソコンは、軽量化・コストダウン等のためビデオカードの質があまり良くないのでかなり遅いケースが考えられます。また、バッテリーが切れ掛かっているときや、コンセントをささずに使用している場合など、省電力モードで動作している可能性があります。</P>
<P>Ｑ）フルスクリーンモードにすると、ドットが荒いようなのですが。<BR>
Ａ）Ｖａｉｏ，ＬａｖｉｅＮＸ等は、解像度を合わせるために”拡大表示”します。他にも、ノートパソコンでは、この現象が見られるものがあります。この場合、ウィンドゥモードで遊ぶようにすれば良いでしょう。（スピードを考慮して、色数は２５６色にしておいてください）</P>
<P>Ｑ）遊んでいるうちに遅くなってくるのですが。<BR>
Ａ）ＯＳ側のメモリ処理の問題だと思います。Windows95/98では特にその問題が大きいです。ＯＳ起動後、なるべく他のソフトを起動させずに、このソフトを起動するようにしてください。また、不必要な常駐物、アクセサリ等を入れていると遅い場合があります。</P>
<P>Ｑ）画面がチラつくのですが<BR>
Ａ）ＦＭ−Ｖ，Ａｐｔｉｖａ等では、ビデオカード側の問題であると考えられます。ビデオカードのドライバを最新のものにしてください。（製造元のホームページで入手できるはずです）</P>
<P>　あるいは、DirectX自体を新しいものに変えると良いです。最新のDirectXについては、マイクロソフト社のホームページからダウンロードできます。また、パソコン雑誌の付録等についてくることもあるので、それを利用しても構いません。</P>
<P>　古いタイプのＦＭ−Ｖの場合、Ｗｉｎｄｏｗｓ９８に変えればチラつきがなくなったという報告があります。</P>
<P>　Ｗｉｎｄｏｗ９５／９８の場合、コントロールパネル→画面で、ハードウェアアクセラレータの使用を抑えれば正常に動作するという報告があります。<BR>
（ただし遅いそうです）</P>
<P>　ウィンドゥモードで、転送の遅いビデオカードを使用していると、移動の際にカクッカクッとなる場合があります。これは、ビデオカードの性質上、やむを得ません。</P>
<P>Ｑ）２５６色、ウィンドゥモードで動かしているのですが、ときどき背景（ゲーム画面外）が、チラつくのですが。</P>
<P>Ａ）フルカラーの壁紙等を使用している場合などにこの現象が起こることがあります。</P>
<P>　ＩＥ４．０等が原因です。　壁紙をなしに設定するか、フルスクリーンモードで使用するようにしてください。</P>
<P>Ｑ）フェードアウトだけがすっごく遅いんですが。<BR>
Ａ）ビデオカードによっては、多色モードでのフェードアウトは、遅いのです。<BR>
　（特にRageIIC等、最近の安売りしているビデオカードに多く見られる現象）<BR>
ゲームのオプションで、「SYSTEM MEMORY」を選択すればフェードアウトは速くなると思いますが、マシンによっては全体的なパフォーマンスを殺してしまいますので、善し悪しです。</P>
<P>///// マウス /////</P>
<P>Ｑ）マウスカーソルがチラつくのですが。<BR>
Ａ）Ｗｉｎｄｏｗ９５／９８ではウインドゥモードでDirectDrawを使用するとマウスがチラつきます。DirectDraw側の仕様と言えます。（ＮＴではちらつきません）マウスカーソルを、標準のものから変更していると、かなり激しくちらつくことがあります。もし気になる場合は、標準のマウスカーソルに変更してみてください。</P>
<P>///// サウンド /////</P>
<P>Ｑ）サウンドに若干の遅延があるのですが。<BR>
Ａ）これは、サウンドカード側の問題です。ソフトウェアMIDI、VirtualSoundCanvas、WinGroove等を使用している場合などは、使用しない設定にしましょう。最近のサウンドカードは、標準でソフトMIDIの機能をインストールするものが有り、知らず知らずのうちにインストールされている場合があります。コントロールパネル→マルチメディアのMIDIで出力先がソフトシンセ等になっていないか確認してください。</P>
<P>Ｑ）サウンドに大きなノイズが乗ってくるのですが。<BR>
Ａ）これは、サウンドカード側の問題です。VirtualSoundCanvas等は使用しないようにしましょう。（他のDirectSoundを利用したゲームもすべてノイズが入るはずです）</P>
<P>Ｑ）サウンドに小さなノイズが乗ってくるのですが。<BR>
Ａ）これは、サウンドカード側のノイズ処理の甘さが主な問題だと思います。</P>
<P>Ｑ）効果音だけ大きい（あるいは小さい）のですが。<BR>
Ａ）ボリュームのバランスの問題です。コントロールパネル→マルチメディアでそれぞれの音量を調節してみましょう。</P>
<P>///// キーボード /////</P>
<P>Ｑ）キーの同時押しが利きにくいのですが。<BR>
Ａ）これは、キーボードのハードウェア的な特性によるものです。コストダウンの為か、キーボードの２個同時押しや３個同時押しが正しく認識されないものが存在するようです。</P>
<P>///// 動かない /////</P>
<P>Ｑ）Ｗｉｎｄｏｗｓ９５／ＷｉｎｄｏｗｓＮＴを使用しているのですが、正常に動きません<BR>
Ａ）DirectX3以降が動く環境にする必要があります。<BR>
　WindowsNTの場合、NT4.0でServicePack3以降のインストールが必須条件です。Ｗｉｎｄｏｗｓ９５ならば、DirectXを別途インストールする必要があります。（DirectXは、マイクロソフト社のホームページからダウンロードできます。また、パソコン雑誌の付録等についてくることもあるので、それを利用しても構いません）</P>
<P>　Ｗｉｎｄｏｗｓ９８は、標準状態でDirectX5がインストールされているので、DirectXをインストールする必要はありません。Windows2000/NT5.0でも、DirectXの問題はないはずです。</P>
<P>-----------------------------------------------------------------------------</P>
<P>最低動作環境<BR>
Pentium 166MHz以上<BR>
Memory 16MB以上<BR>
ビデオメモリ 2MB以上<BR>
サウンドカード<BR>
<BR>
推奨環境<BR>
Pentium 233MHz以上<BR>
Memory 64MB以上<BR>
ビデオメモリ 8MB以上<BR>
サウンドカード</P>
<HR>
</BODY></HTML>
